@inherits LayoutComponentBase

<MudThemeProvider Theme="NetChan" />

<MudLayout>
	<BoardListBar Boards="@Boards"/>
	<MudMainContent>
		@Body
	</MudMainContent>
	<BoardListBar Boards="@Boards"/>
</MudLayout>

@code {
	MudTheme NetChan = new MudTheme() {
		Palette = new Palette() {
			Primary = Colors.Blue.Accent1,
			Secondary = Colors.Blue.Lighten3,
			Background = Colors.Blue.Lighten5
		},

		LayoutProperties = new LayoutProperties() {
			DefaultBorderRadius = "0",
			AppbarMinHeight = "20px"
		}
	};

	public string[] Boards { get; set; }

	protected override async Task OnInitializedAsync() {
		var url = config.GetSection("Api")["Url"];
		IFlurlResponse response;
		try {
			response = await $"{url}/api/frontpage/boards".GetAsync();
		} catch {
			return;
		}

		var boards = await response.ResponseMessage.Content.ReadFromJsonAsync<Dictionary<string, string>>();
		Boards = boards.Keys.ToArray();
	}
}